# 平台功能与产品设计

本文档从产品与交互角度，描述 AI DApp + 游戏币平台的功能范围与 MVP 版本的具体能力。

---

## 1. 角色与用户类型

- 普通用户
  - 注册 / 登录
  - 使用 AI 功能（聊天 / 生成）
  - 查看游戏币余额与交易记录
  - 参加任务 / 活动，领取奖励
- 管理员
  - 登录后台管理界面
  - 查看用户与交易数据
  - 配置初始赠币、任务与活动奖励
  - 手动发币 / 封禁异常用户（后续扩展）

---

## 2. MVP 功能清单（平台侧）

### 2.1 用户与账号系统

- 邮箱 / 手机号注册
- 邮箱 / 手机号 + 密码登录（或短信验证码登录）
- 会话保持（JWT / Session Token）
- 查看个人资料（昵称、头像等，MVP 可简化）

### 2.2 游戏币系统（链下）

- 用户有一个默认游戏币余额字段（例如 `balance`）
- 交易流水记录（`transactions`）
  - `type`：`recharge`（充值）、`reward`（奖励）、`cost`（扣费）
  - `amount`：正负数，正数表示收入，负数表示支出
  - `created_at`：时间戳
  - `meta`：扩展信息（如来源任务、AI 调用 ID 等）
- 初始赠币
  - 新用户注册成功后自动发放一定数量的游戏币
- 奖励发放
  - 完成任务（例如首次使用 AI）后发放奖励
  - 管理员后台可手动发放
- 扣费
  - 每次 AI 调用前检查余额
  - 足够则扣费并记录流水；不足则返回错误提示

### 2.3 AI 使用流程（平台视角）

- 前端通过平台后端发起 AI 请求
- 平台后端完成：
  - 认证校验
  - 余额检查与扣费
  - 调用 AI 服务
  - 返回 AI 返回结果与本次扣费信息（可选）

### 2.4 任务与奖励（MVP 简化）

MVP 可以先实现少量内置任务：

- 任务示例
  - 完成注册 → 奖励 X 游戏币（可与初始赠币合并）
  - 首次成功使用 AI → 奖励 X 游戏币
  - 每日首次登录 → 奖励 X 游戏币
- 用户可以在「任务」页面查看任务状态与可领取奖励
- 任务系统基础结构为后续扩展（邀请好友、分享等）预留空间

### 2.5 钱包 / 账本展示

- 钱包页展示内容：
  - 当前余额
  - 可用额度（预留，考虑冻结 / 占用等后续扩展）
  - 近期交易列表（充值、奖励、扣费）
- 交易列表可按时间筛选 / 分页

### 2.6 管理后台（MVP 简化版本）

- 管理员登录（简单账号密码）
- 基础能力：
  - 查看用户列表（基本信息、余额）
  - 查看交易列表（支持按用户 / 时间筛选）
  - 手动给某个用户发放游戏币（如运营补偿）

---

## 3. 用户使用路径（MVP）

### 3.1 新用户路径

1. 打开网页，看到登录 / 注册入口
2. 选择注册，输入邮箱 / 手机号 + 密码（或验证码）
3. 注册成功后自动登录，并获得初始赠币
4. 页面引导用户进入 AI 对话页面
5. 在 AI 对话页使用一次 AI 功能（消耗少量游戏币）
6. 完成「首次使用 AI」任务，获得一次奖励
7. 用户在钱包页看到余额变化与流水

### 3.2 老用户路径

1. 登录后直接进入 AI 对话页
2. 继续使用 AI 功能，游戏币被持续扣费
3. 根据任务 / 活动参与获得奖励
4. 如果余额不足，则提示用户通过任务或充值补充游戏币

---

## 4. 游戏化体验设计

MVP 阶段先以「轻游戏化」为主：

- 视觉上：
  - 钱包页用「金币 / 水晶」等图标表现
  - AI 使用时展示「本次消耗 X 游戏币」
- 行为上：
  - 初始赠币 + 首次任务奖励让用户有「免费体验」的感觉
  - 任务系统提供简单目标（如「今日完成 3 次对话」）
- 未来可扩展：
  - 抽奖（消耗一定游戏币有机会获得更多）
  - 成就系统（累计使用次数、连续登录天数等）
  - 排行榜（消耗 / 贡献等）

---

## 5. 与 AI 服务的边界

平台与 AI 服务之间的职责划分：

- 平台负责：
  - 用户身份和权限
  - 游戏币计费与扣费
  - 请求限频与风控
  - AI 使用日志与业务层监控
- AI 服务负责：
  - 模型推理与多模态能力
  - 模型层的性能优化与监控

通信方式建议：

- 平台通过 HTTP 调用 AI 服务
  - 将用户输入、会话上下文等传过去
  - 同时带上必要的鉴权信息（API Key 等）
- AI 服务返回：
  - `answer`：回复内容
  - `usage`：Token 数 / 计算量等（供平台可选用于更精细计费）

---

## 6. 非 MVP 范围（后续阶段）

以下功能在文档中预留设计，但不强制在第一阶段实现：

- 完整任务系统（包括复杂条件与奖励配置）
- 抽奖与活动系统
- AI 内容上链与 NFT 化
- DAO 治理与 Token 经济
- 多模型选择与模型市场

这些功能会在 `docs/ROADMAP.md` 中按阶段进行拆解与规划。

